function locationDetailsViewModel(){var i=this;if(i.roomDescription=ko.observable(),i.details=ko.observableArray([]),i.setupDetails=ko.observableArray([]),i.features=ko.observableArray([]),i.images=ko.observableArray([]),i.imageModalIsOpen=ko.observable(!1),i.hideViewAllDetails=ko.observable(!1),i.buildingId=ko.observable(),i.roomId=ko.observable(),i.locationDetailsUrl=ko.observable(),i.timeZoneTitle=ko.observable(""),i.availableStartDate=ko.observable(moment().startOf("day")),i.hide=function(){return $("#location-details-modal").modal("hide"),!1},i.show=function(n,t,r,u){if((!n||n<=0)&&(!t||t<=0))return!1;i.buildingId(n?n:0),i.roomId(t?t:0),i.hideViewAllDetails(!!u),i.details([]),i.setupDetails([]),i.features([]),i.images([]),$("#location-details-tabs li a").eq(0).click();var f=JSON.stringify({buildingId:n,roomId:t});return vems.ajaxPost({url:vems.serverApiUrl()+"/GetLocationDetails",data:f,success:function(n){var u=JSON.parse(n.d),t,f;u.Success?(t=JSON.parse(u.JsonData),i.roomDescription(t.RoomDescription),i.details(t.RoomDetailsCollection),$("#location-details-modal").modal("show"),i.setupDetails(t.SetupTypes),i.features(t.Features),i.images(t.RoomImages),i.locationDetailsUrl(t.LocationDetailsUrl)):(i.hide(),vems.showToasterMessage("",u.ErrorMessage,"warning",2e3)),f=t.BuildingTimeZoneInfo.TimeZone,i.timeZoneTitle(f),$(document).off("click","#availability-tab");$(document).on("click","#availability-tab",function(){i.getAvailabilityForDate(moment().startOf("day"))});$("#room-availability-control").data("verticalBookGrid")===undefined&&$("#room-availability-control").verticalBookGrid({startHour:t.AvailabilityStartHour,parentElement:$("#location-details-modal .modal-body"),scrollElement:$("#room-availability-control"),displayDayCount:1,displayDateHeaders:!1,isModal:!0}),r&&$.isFunction(r)&&r(!1)},error:function(n,t,i){return r&&$.isFunction(r)&&r(!1),console.log(i),!1}}),!1},i.openImageModal=function(n,t){var u=$(t.target).attr("src"),r=$("#bldg-room-image-modal"),f=$("#bldg-room-image-modal .modal-dialog"),e=$("#bldg-room-image-modal .modal-content"),o=t.target;i.imageModalIsOpen(!0),i.sizeImageModal(r,f,e,o),$("#bldg-room-image-img").attr("src",u),r.modal("show");r.one("hidden.bs.modal",function(){i.imageModalIsOpen(!1)})},i.downloadPDF=function(n){for(var u=atob(n.BinaryData),f=new Array(u.length),e,r,t,o,i=0;i<u.length;i++)f[i]=u.charCodeAt(i);e=new Uint8Array(f),r=new Blob([e],{type:"application/pdf"}),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(r,n.Description+n.FileExtension):(t=document.createElement("a"),o=window.URL.createObjectURL(r),t.href=window.URL.createObjectURL(r),t.download=n.Description+".pdf",document.body.appendChild(t),t.click(),document.body.removeChild(t))},i.downloadAttachment=function(n){var t=document.createElement("a");t.href=n.AttachmentLink,document.body.appendChild(t),t.click(),document.body.removeChild(t)},i.sizeImageModal=function(n,t,r,u){var h,f;if(i.imageModalIsOpen()){var c=navigator.platform==="iPhone"||navigator.platform==="iPod",s=parseInt(t.css("margin-top"))+parseInt(t.css("margin-bottom")),l=u.naturalWidth/u.naturalHeight,o=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-s,e=Math.max(document.documentElement.clientWidth,window.innerWidth||0)-s;c&&(o=o-30),h=e>o,f=h?o*l:e-s,f>e&&(f=e),r.css("margin-left",function(){return f>event.target.naturalWidth||f===e?15:0}),t.css("width",function(){return f>event.target.naturalWidth?event.target.naturalWidth:f})}},i.viewAllDetailsClicked=function(){window.location=i.locationDetailsUrl()},i.changeAvailableDate=function(n,t){var r=t.currentTarget.id=="available-next"?1:-1;i.getAvailabilityForDate(moment(i.availableStartDate()).add(r,"day"))},i.getAvailabilityForDate=function(n){i.availableStartDate(n),vems.ajaxPost({url:vems.serverApiUrl()+"/GetLocationDetailsAvailability",data:JSON.stringify({roomId:i.roomId(),start:moment(i.availableStartDate()),end:moment(i.availableStartDate()).add(1,"day")}),success:function(n){var t=JSON.parse(n.d),r=JSON.parse(t.JsonData),u=r.bookings;$("#room-availability-control").data("verticalBookGrid").setStartDate(i.availableStartDate(),u)},error:function(n,t,i){return console.log(i),!1}})},DevExpress.devices.real().phone)$("#location-details-modal").off("shown.bs.modal").on("shown.bs.modal",function(){vems.convertTabsForMobile()})}var vems=vems||{};(function(n){function u(u){r=this,t=n.extend({},n.fn.verticalBookGrid.defaults,u),n.extend(r,{init:function(){i.addClass("vertical-book-grid-container"),t.isModal&&i.css("overflow","auto").css("height","220px"),r.buildGrid();n(window).on("resize",function(){var n=t.parentElement.width()-80;i.find(".v-b-cal-column").css("width",parseInt(n/t.displayDayCount,10)+"px")})},buildGrid:function(r){var e,o,u,p,c,s,w,h,l,f,b;t.events=r===undefined?[]:r,i.children().remove(),e=n('<div class="v-b-container"><\/div>'),o=n('<div class="v-b-time-column"><\/div>'),t.displayDateHeaders&&o.append(n("<div class=v-b-time-ph><\/div>"));var a=n('<div class="v-b-days-container"><\/div>'),v=n('<div class="v-b-cal-column"><\/div>'),y=moment(t.startDate);for(u=0;u<t.hoursToDisplay;u++)p=moment(y).add(u,"hour"),c=n('<div class="v-b-time"><span>'+p.format(t.timeFormat)+"<\/span><\/div>"),u===0&&c.css("top","-4px"),o.append(c),s=n('<div class="v-b-hour" data-hour="'+u+'"><\/div>'),s.append(n('<div class="v-b-top-half-hour" data-hour="'+u+'"><\/div>')),s.append(n('<div class="v-b-bottom-half-hour" data-hour="'+u+'"><\/div>')),v.append(s);for(e.append(o),w=t.parentElement.width()-80,h=0;h<t.displayDayCount;h++)l=moment(y).add(h,"day"),f=v.clone(),f.css("width",parseInt(w/t.displayDayCount,10)+"px"),t.displayDateHeaders&&f.prepend(n('<div class="v-b-date">'+l.format(t.dayFormat)+"<\/div>")),b=n.grep(t.events,function(n){return moment(n.Start).startOf("day").isSame(l)}),n.each(b,function(i,r){var e=t.displayDateHeaders?r.Position+50:r.Position,u;t.isModal?(u=n('<div class="v-b-event" style="top: '+e+"px; height: "+r.Height+'px"><span>'+r.Title+"<\/span><span>"+moment(r.Start).format(t.timeFormat)+" - "+moment(r.End).format(t.timeFormat)+"<\/span><\/div>"),f.prepend(u)):(u=n('<div class="v-b-event" style="top: '+e+"px; height: "+r.Height+'px"><span>'+r.Title+"<\/span><span>"+moment(r.Start).format(t.timeFormat)+" - "+moment(r.End).format(t.timeFormat)+"<\/span><\/div>"),f.prepend(u))}),a.append(f);e.append(a),i.append(e),t.scrollElement.length>0&&t.scrollElement.scrollTop(t.startHour*60-10)},setStartDate:function(n,i){t.startDate=moment(n).startOf("day"),r.buildGrid(i)},getStartDate:function(){return t.startDate}})}var r,i,t;n.fn.verticalBookGrid=function(n){var f=this,r,t;return(i=this,r=this.data("deaVerticalBook"),r)?r:(this.each(function(){var r=new u(n),i;r.init(),i=f.data("verticalBookGrid",r),t=t?t.add(i):i}),t?t:this)},n.fn.verticalBookGrid.defaults={startDate:moment().startOf("day"),events:[],displayDayCount:7,displayDateHeaders:!0,startHour:8,hoursToDisplay:24,parentElement:"",scrollElement:"",dayFormat:"ddd, MMM Do",timeFormat:"LT"}})(jQuery)