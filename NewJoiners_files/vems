function instatiateFloormapComponent(){ko.components.register("floorplans-reserve",{template:{fromUrl:"Scripts/modules/floorplans/reserve/FloorPlansReserve.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return vems.floorPlanVM=new floorPlansReserveVM(n,t)}}})}function showEmsDiag(n,t){var i=n;typeof n=="string"&&(i=$("#"+n)),i.dialog("destroy"),i.dialog(t),i.dialog("open")}function b64EncodeUnicode(n){return btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,function(n,t){return String.fromCharCode("0x"+t)}))}function convertSvgBinaryToXML(n){var i=atob(n),t;return i=i.replace(/(\r\n|\n|\r)/gm,""),t="",$(i).each(function(n,i){i.tagName&&i.tagName.toLowerCase()=="svg"&&(t=i)}),$(t).removeAttr("height").removeAttr("width"),b64EncodeUnicode($("<div>").append(t).html())}var vems=vems||{},templateFromUrlLoader={loadTemplate:function(n,t,i){if(t.fromUrl){var r=t.fromUrl+"?cacheAge="+t.maxCacheAge;$.get(r,function(t){ko.components.defaultLoader.loadTemplate(n,t,i)})}else i(null)}},$activeTipId,NS_XHTML,NS_STATE,Dea,_emsLabelsOnPage,iFrameDiag,koValueBindingInit,koValueBindingUpdate,koTextInputBindingInit;ko.components.loaders.unshift(templateFromUrlLoader),ko.components.register("udf-display-component",{template:{fromUrl:"Scripts/modules/user-defined-fields/UDFTemplate.html",maxCacheAge:1234},viewModel:{createViewModel:function(n){return n}}}),ko.components.register("service-udf-component",{template:{fromUrl:"Scripts/modules/user-defined-fields/service-udf-template.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return new serviceUdfViewModel(n,t)}}}),vems.bookingDetailsVM=vems.bookingDetailsVM||{},ko.components.register("booking-details-component",{template:{fromUrl:"Scripts/modules/booking-details/booking-details-template.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){var i={ShowICS:ko.isObservable(n.ShowICS)?n.ShowICS():!1,ScreenText:n.ScreenText};return vems.bookingDetailsVM=new bookingDetailsViewModel(i,t)}}}),vems.bookingServicesVM=vems.bookingServicesVM||{},ko.components.register("booking-services-component",{template:{fromUrl:"Scripts/modules/booking-services/booking-services-template.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return vems.bookingServicesVM=new bookingServicesViewModel(n,t)}}}),vems.locationDetailsVM=vems.locationDetailsVM||{},ko.components.register("location-details-component",{template:{fromUrl:"Scripts/modules/location-details/location-details-template.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){var i={ScreenText:n.ScreenText};return vems.locationDetailsVM=new locationDetailsViewModel(i,t)}}}),vems.addAGroupVM=vems.addAGroupVM||{},ko.components.register("add-a-group-modal",{template:{fromUrl:"Scripts/modules/add-a-group/add-a-group-template.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){var i={templateId:n.templateId,ScreenText:n.ScreenText,onCloseCallback:n.onCloseCallback,helpTextElementId:n.helpTextElementId};return vems.addAGroupVM=new AddAGroupViewModel(i,t)}}}),vems.addAContactVM=vems.addAContactVM||{},ko.components.register("add-contacts-modal",{template:{fromUrl:"Scripts/modules/add-contacts/add-contacts-template.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return vems.addAContactVM=new AddContactsViewModel(n,t)}}}),ko.components.register("weekly-view-component",{template:{fromUrl:"Scripts/modules/weekly-view/weekly-view-template.html",maxCacheAge:1234},viewModel:{createViewModel:function(n){return n}}}),ko.components.register("web-template-modal-component",{template:{fromUrl:"Scripts/modules/home/WebTemplateModalComponent.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n){return n}}}),ko.components.register("booking-search-component",{template:{fromUrl:"Scripts/modules/home/BookingSearchComponent.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n){return n}}}),ko.components.register("summary-services-component",{template:{fromUrl:"Scripts/modules/summary-services/summary-services.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return vems.summaryServicesVM=new summaryServicesViewModel({},t)}}}),ko.components.register("webapp-checkbox-component",{template:{fromUrl:"Scripts/modules/common/webapp-checkbox.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return new webappCheckboxViewModel(n,t)}}}),ko.components.register("cancel-reason-dialog",{template:{fromUrl:"Scripts/modules/cancel-reason/CancelReason.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n){return n}}}),vems.floorPlanVM=vems.floorPlanVM||{},instatiateFloormapComponent(),vems.floorPlanModalVM=vems.floorPlanModalVM||{},ko.components.register("floorplans-reserve-modal",{template:{fromUrl:"Scripts/modules/floorplans/reserve/FloorPlansReserveModal.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n,t){return vems.floorPlanModalVM=new floorPlansReserveVM(n,t)}}}),ko.components.register("recurrence-modal-component",{template:{fromUrl:"Scripts/modules/room-request/RecurrenceModalComponent.aspx",maxCacheAge:1234},viewModel:{createViewModel:function(n){return n}}}),function(n){n.fn.addRowHighlights=function(t){var i={highlightCss:"ui-state-highlight",thCss:"white-widget-header"};return t=n.extend(i,t),this.each(function(){var i=n(this);i.addClass("ui-widget");i.find("tr").on("mouseover mouseout",function(i){i.type==="mouseover"?n(this).children("td:not(.ui-widget-header)").addClass(t.highlightCss):n(this).children("td").removeClass(t.highlightCss)});i.find("th").addClass(t.thCss),i.find("td:not(.ui-widget-header)").addClass("ui-widget-content")})}}(jQuery),$activeTipId=0,function(n){n.fn.emsTip=function(t){var u={tipDelay:1e3,hideDelay:500,callbackRouter:"getTip",tag:"tr"},r,i;return t=n.extend(u,t),r=null,i=null,n("#tipDiv").mouseover(function(){i&&clearTimeout(i),r&&clearTimeout(r)}),n("#tipDiv").mouseout(function(){i&&clearTimeout(i),r&&clearTimeout(r),i=setTimeout(function(){$activeTipId=0,n("#tipDiv").dialog("close")},t.hideDelay)}),n(".ui-dialog").mouseover(function(){i&&clearTimeout(i),r&&clearTimeout(r)}),n(".ui-dialog").mouseout(function(){i&&clearTimeout(i),r&&clearTimeout(r),i=setTimeout(function(){$activeTipId=0,n("#tipDiv").dialog("close")},t.hideDelay)}),this.each(function(){var u=n(this);u.find("[data-tipId]").mouseover(function(u){r&&clearTimeout(r),i&&clearTimeout(i);var f=n(this).attr("data-tipId");f!==""&&$activeTipId!==f&&(n("#tipDiv").dialog("close"),r=setTimeout(function(){Dea.mouseX=u.pageX,Dea.mouseY=u.pageY,Dea.setEmsData(!0),Dea.emsData.tipItemId=f,Dea.makeCallback(t.callbackRouter)},t.tipDelay))}).mouseout(function(){i&&clearTimeout(i),r&&clearTimeout(r),i=setTimeout(function(){$activeTipId=0,n("#tipDiv").dialog("close")},t.hideDelay)})})}}(jQuery),function(n){function s(t,i,r){f(t,n(i).text()),r.hide()}function f(t,i){n(t).val(i),n(t).change()}function t(n){n.value="",alert(ems_InvalidTime)}function c(i,u){var h="",s,o,l;h=n(i).val().toLowerCase(),h=h.replace(" ","");var a=e(h,u),v=a[0],c=a[1];if(v===""){n(i).val("");return}if(s=v.split(u.separator),s.length===1)try{if(s[0].length>2){t(i);return}if(o=Number(s[0]),o>=0&&o<24){c==="pm"?o<12&&(o+=12):c==="am"&&o===12&&(o=0),f(i,r(new Date(0,0,0,o,0,0),u));return}t(i);return}catch(y){t(i);return}else if(s.length===2||s.length===3)try{if(o=Number(s[0]),l=Math.floor(Number(s[1])),l>=0&&l<60){if(o>=0&&o<24){c==="pm"?o<12&&(o+=12):c==="am"&&o===12&&(o=0),f(i,r(new Date(0,0,0,o,l,0),u));return}t(i);return}t(i);return}catch(y){t(i);return}else{t(i);return}}function r(n,t){var u=n.getHours(),f=t.use24Format?u:(u+11)%12+1,r=t.timeFormat.toLowerCase(),e=n.getMinutes();return t.use24Format?(r=r.replace("hh",i(f)),r=r.replace("h",i(f))):(r=r.replace("hh",f),r=r.replace("h",f)),r=r.replace("mm",i(e)),r=r.replace("m",i(e)),r=r.replace("ss",i(0)),r=r.replace("s",i(0)),r=r.replace("tt",u<12?t.am:t.pm),r=r.replace("t",u<12?t.am:t.pm)}function e(n,t){var u=n.length,r="",i;return u>1?(i=n,t.am.length>0&&(n.endsWith(t.am)?(i=n.substring(0,u-t.am.length),r="am"):n.endsWith(t.pm)?(i=n.substring(0,u-t.pm.length),r="pm"):n.endsWith(t.am.substring(0,1))?(i=n.substring(0,u-1),r="am"):n.endsWith(t.pm.substring(0,1))?(i=n.substring(0,u-1),r="pm"):n.startsWith(t.am)?(i=n.substr(t.am.length),r="am"):n.startsWith(t.pm)&&(i=n.substr(t.pm.length),r="pm"))):i=n,[i,r]}function i(n){return(n<10?"0":"")+n}function o(n,t){return typeof n=="object"?u(n):h(n,t)}function h(n,t){var f;if(n){var r=n.split(t.separator),i=parseFloat(e(r[0],t)[0]),o=parseFloat(e(r[1],t)[0]);return t.use24Format||(i===12&&n.indexOf(t.am)!==-1?i=0:i!==12&&n.indexOf(t.pm)!==-1&&(i+=12)),f=new Date(0,0,0,i,o,0),u(f)}return null}function u(n){return n.setFullYear(2001),n.setMonth(0),n.setDate(0),n}n.fn.timePicker=function(t){var i={increment:15,startTime:new Date(0,0,0,0,0,0),endTime:new Date(0,0,0,23,45,0),separator:ems_timeSep,am:ems_AM,pm:ems_PM,timeFormat:ems_timeFormat,use24Format:ems_timeFormat.indexOf("t")===-1},r=n.extend(i,t);return this.each(function(){n.timePicker(this,r)})},n.timePicker=function(t,i){var r=n(t)[0];return r.timePicker||(r.timePicker=new jQuery._timePicker(r,i))},n._timePicker=function(t,i){var v=!1,b=!1,l=o(i.startTime,i),k=o(i.endTime,i),y,a,f,e,p,d,w,g;for(n(t).attr("autocomplete","OFF"),n(t).css("width","7em"),y=[],a=new Date(l);a<=k;)y[y.length]=r(a,i),a=new Date(a.setMinutes(a.getMinutes()+i.increment));for(f=n('<div class="ui-timePicker'+(i.use24Format?"":" ui-timePicker-12hours")+'"><\/div>'),e=n("<ul><\/ul>"),p=0,d=y.length;p<d;p++)e.append("<li>"+y[p]+"<\/li>");f.append(e),f.appendTo("body").hide(),f.mouseover(function(){v=!0}).mouseout(function(){v=!1}),n("li",e).mouseover(function(){b||(n("li.tpSelected",f).removeClass("tpSelected"),n(this).addClass("tpSelected"))}).mousedown(function(){v=!0}).click(function(){s(t,this,f,i),v=!1}),w=function(){var s,o;if(f.is(":visible"))return!1;n("li",f).removeClass("tpSelected"),s=n(t).offset(),f.css({position:"absolute",top:s.top+21+"px",left:s.left+"px","z-index":99999}),f.show(),n(t).focus();var c=n(t).val()?h(n(t).val(),i):l,a=l.getHours()*60+l.getMinutes(),v=c.getHours()*60+c.getMinutes()-a,y=Math.round(v/i.increment),e=u(new Date(0,0,0,0,y*i.increment+a,0));return e=l<e&&e<=k?e:l,o=n("li:contains("+r(e,i)+")",f),o.length&&(o.addClass("tpSelected"),f[0].scrollTop=o[0].offsetTop),!0},n(t).after('<img id="tp'+n(t).attr("id")+'" src="Images/btn-TimePicker.png" class="ui-timePicker-trigger" alt="'+ems_timePicker+'" title="'+ems_timePicker+'" style="vertical-align:bottom" />'),n("img[src*='btn-TimePicker.png'], #tp"+n(t).attr("id")).hover(function(){n(this).attr("src","images/btn-TimePicker-over.png")},function(){n(this).attr("src","images/btn-TimePicker.png")}),n("#tp"+n(t).attr("id")).click(w),n(t).blur(function(){v||(f.hide(),c(t,i))}),g=n.browser.mozilla?"keypress":"keydown",n(t)[g](function(r){var u,c,o,h;b=!0,c=f[0].scrollTop;switch(r.keyCode){case 38:return w()?!1:(u=n("li.tpSelected",e),o=u.prev().addClass("tpSelected")[0],o?(u.removeClass("tpSelected"),o.offsetTop<c&&(f[0].scrollTop=c-o.offsetHeight)):(u.removeClass("tpSelected"),o=n("li:last",e).addClass("tpSelected")[0],f[0].scrollTop=o.offsetTop-o.offsetHeight),!1);case 40:return w()?!1:(u=n("li.tpSelected",e),h=u.next().addClass("tpSelected")[0],h?(u.removeClass("tpSelected"),h.offsetTop+h.offsetHeight>c+f[0].offsetHeight&&(f[0].scrollTop=c+h.offsetHeight)):(u.removeClass("tpSelected"),h=n("li:first",e).addClass("tpSelected")[0],f[0].scrollTop=0),!1);case 13:return f.is(":visible")&&s(t,n("li.tpSelected",e)[0],f,i),!1;case 27:return f.hide(),!1}return!0}),n(t).keyup(function(){b=!1}),this.getTime=function(){return o(t.value,i)},this.setTime=function(f){t.value=r(u(f),i),n(t).change()}}}(jQuery),function(n){n.maxZIndex=n.fn.maxZIndex=function(t){var r={inc:10,group:"*"},i;return(n.extend(r,t),i=0,n(r.group).each(function(){var t=parseInt(n(this).css("z-index"));i=t>i?t:i}),!this.jquery)?i:this.each(function(){i+=r.inc,n(this).css("z-index",i)})}}(jQuery),(typeof Dea=="undefined"||null===Dea)&&(Dea={}),Dea.JSON={},function(){function i(n){return n<10?"0"+n:n}function e(n){return f.lastIndex=0,f.test(n)?'"'+n.replace(f,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var c,l,s,a,v=n,h,o=f[i];o&&typeof o=="object"&&typeof o.toJSON=="function"&&(o=o.toJSON(i)),typeof t=="function"&&(o=t.call(f,i,o));switch(typeof o){case"string":return e(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(n+=r,h=[],Object.prototype.toString.apply(o)==="[object Array]"){for(a=o.length,c=0;c<a;c+=1)h[c]=u(c,o)||"null";return s=h.length===0?"[]":n?"[\n"+n+h.join(",\n"+n)+"\n"+v+"]":"["+h.join(",")+"]",n=v,s}if(t&&typeof t=="object")for(a=t.length,c=0;c<a;c+=1)l=t[c],typeof l=="string"&&(s=u(l,o),s&&h.push(e(l)+(n?": ":":")+s));else for(l in o)Object.hasOwnProperty.call(o,l)&&(s=u(l,o),s&&h.push(e(l)+(n?": ":":")+s));return s=h.length===0?"{}":n?"{\n"+n+h.join(",\n"+n)+"\n"+v+"}":"{"+h.join(",")+"}",n=v,s}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var o=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof Dea.JSON.stringify!="function"&&(Dea.JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.DEAstringify");return u("",{"":i})}),typeof Dea.JSON.parse!="function"&&(Dea.JSON.parse=function(text,reviver){function walk(n,t){var r,u,i=n[t];if(i&&typeof i=="object")for(r in i)Object.hasOwnProperty.call(i,r)&&(u=walk(i,r),u!==undefined?i[r]=u:delete i[r]);return reviver.call(n,t,i)}var j;return o.lastIndex=0,text=text.replace(o,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)}),j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j})}(),String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},String.prototype.startsWith=function(n,t){return t?this.match("^"+n)==n:(n=n.toLowerCase(),this.toLowerCase().match("^"+n)==n)},String.prototype.endsWith=function(n,t){return t?this.match(n+"$")==n:(n=n.toLowerCase(),this.toLowerCase().match(n+"$")==n)},String.prototype.endsWithSuffix=function(n){return this.indexOf(n,this.length-n.length)!==-1},String.prototype.format=function(){var n=/\{\d+\}/g,t=arguments;return this.replace(n,function(n){return t[n.match(/\d+/)]})},Array.prototype.remove=function(n,t){var i=this.slice((t||n)+1||this.length);return this.length=n<0?this.length+n:n,this.push.apply(this,i)},Array.prototype.removeValue=function(n){for(var t=0,i=this.length;t<i;t++)if(this[t]===n)return this.remove(t);return this},Array.prototype.toList=function(n){var i="",t,r;for(n||(n=","),t=0,r=this.length;t<r;t++)t===0?i=this[t]:i+=n+this[t];return i},NS_XHTML="http://www.w3.org/1999/xhtml",NS_STATE="http://www.w3.org/2005/07/aaa",(typeof Dea=="undefined"||null===Dea)&&(Dea={}),Dea.emsData={},Dea.Mouse={},_emsLabelsOnPage=null,iFrameDiag=null,Dea.Keys={PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,TAB:9,BACKSPACE:8,DELETE:46,ENTER:13,INSERT:45,ESCAPE:27},Dea.isNumberKey=function(n){return n>47&&n<58?!0:!1},Dea.isNavKey=function(n){return n===Dea.Keys.LEFT||n===Dea.Keys.RIGHT||n===Dea.Keys.UP||n===Dea.Keys.DOWN||n===Dea.Keys.BACKSPACE||n===Dea.Keys.HOME||n===Dea.Keys.END||n===Dea.Keys.TAB?!0:!1},Dea.numberMask=function(n){var t=n.which||n.keyCode;return t==46?!0:n.shiftKey&&t==35||n.shiftKey&&t==36||n.shiftKey&&t==37?!1:n.ctrlKey&&t==118?!0:Dea.isNumberKey(t)||Dea.isNavKey(t)},Dea.keyUpTypeVal=function(n,t){var i=n.target||n.srcElement,r=new RegExp(t);r.test($(i).val())||$(i).val("")},Dea.floatMask=function(n){var t=n.which||n.keyCode;return Dea.isNumberKey(t)||Dea.isNavKey(t)||t===46||t==44},Dea.suppressSubmitOnReturn=function(n){var t=n.which||n.keyCode;if(t===Dea.Keys.ENTER)return!1},Dea.matchEmsDataId=function(n,t){for(var u,i=0,r=n.length;i<r;i++)if((u=n[i].emsDataId||n[i].getAttribute("emsDataId"),u===t)||n[i].name===t)return n[i];return null},Dea.Get=function(n,t){var i=n;if(typeof n=="string"){if(n.trim()===""||n==="undefined")return null;i=document.getElementById(n)}else typeof n=="function"&&(i=n());return i?i:(i=null,t&&t!==null||(t=document.getElementsByTagName("input")),i=Dea.matchEmsDataId(t,n),i!==null)?i:(t=document.getElementsByTagName("select"),i=Dea.matchEmsDataId(t,n),i!==null)?i:(t=document.getElementsByTagName("textarea"),i=Dea.matchEmsDataId(t,n),i!==null)?i:null},Dea.setDisplay=function(n,t,i,r,u,f){n=Dea.Get(n),n&&(t==="none"||t==="hidden"?n.setAttribute("aria-hidden","true"):n.setAttribute("aria-hidden","false"),n.style.display=t,u&&u!==null&&(n.style.position=u),i&&i!==null&&(n.style.left=i),r&&r!==null&&(n.style.top=r),f&&f!==null&&(n.style.right=f))},Dea.findPos=function(n){if(n=Dea.Get(n),n){var t=curtop=0;if(n.offsetParent)for(t=n.offsetLeft,curtop=n.offsetTop;n=n.offsetParent;)t+=n.offsetLeft,curtop+=n.offsetTop}return[t,curtop]},Dea.Css={classExists:function(n,t){return n=Dea.Get(n),new RegExp("\\b"+t+"\\b").test(n.className)},swapClass:function(n,t,i){n=Dea.Get(n),n.className=Dea.Css.classExists(n,t)?n.className.replace(t,i):n.className.replace(i,t)},addClass:function(n,t){n=Dea.Get(n),Dea.Css.classExists(n,t)||(n.className+=n.className?" "+t:t)},removeClass:function(n,t){if(n=Dea.Get(n),n.className){var i=n.className.match(" "+t)?" "+t:t;n.className=n.className.replace(i,"")}}},Dea.emptyToMinusOne=function(n){return n?n===""?"-1":n:"-1"},Dea.setEmsData=function(n){for(var i=document.getElementsByTagName("input"),r,f,u,o,t=0,e=i.length;t<e;t++)if(u=i[t].emsDataId||i[t].getAttribute("emsDataId"),o=i[t].isRequired||i[t].getAttribute("isRequired"),u){if(o&&i[t].value===""&&n!==!0)return alert(i[t].errorMsg),!1;Dea.emsData[u]=i[t].type==="checkbox"||i[t].type==="radio"?i[t].checked?"1":"0":i[t].value}else i[t].name.substring(0,4)==="ems_"&&(Dea.emsData[i[t].name]=i[t].type==="checkbox"?i[t].checked?"1":"0":i[t].value);for(r=document.getElementsByTagName("select"),t=0,e=r.length;t<e;t++)if(u=r[t].emsDataId||r[t].getAttribute("emsDataId"),o=r[t].isRequired||r[t].getAttribute("isRequired"),u){if(o&&(r[t].value===""||r[t].options[r[t].selectedIndex].text==="")&&n!==!0)return alert(r[t].errorMsg),!1;Dea.emsData[u]=Dea.emptyToMinusOne(r[t].value)}for(f=document.getElementsByTagName("textarea"),t=0,e=f.length;t<e;t++)if(u=f[t].emsDataId||f[t].getAttribute("emsDataId"),o=f[t].isRequired||f[t].getAttribute("isRequired"),u){if(o&&f[t].value===""&&n!==!0)return alert(f[t].errorMsg),!1;Dea.emsData[u]=f[t].value}return!0},Dea.getValue=function(n,t,i){return n=Dea.Get(n,t),n?n.value.trim():i?i:""},Dea.setValue=function(n,t,i){n=Dea.Get(n,i),n&&(n.value=t)},Dea.setHtml=function(n,t){n=Dea.Get(n),n&&(n.innerHTML=t)},Dea.checkLength=function(n,t,i){if(Dea.Get(t).value.length<i)return!0;var r=n.which||n.keyCode;return r===Dea.Keys.UP||r===Dea.Keys.RIGHT||r===Dea.Keys.LEFT||r===Dea.Keys.DOWN||r===Dea.Keys.BACKSPACE||r===Dea.Keys.DELETE?!0:!1},Dea.showError=function(n,t,i){if(n=Dea.Get(n,t),n){i&&(typeof i=="string"&&(i=Dea.Get(i,t)),$(i).click());var r=n.errorMsg||n.getAttribute("errorMsg");alert(r),n.focus()}},Dea.setDisabled=function(n,t,i){n=Dea.Get(n,i),n&&(t?$(n).attr("disabled","disabled"):$(n).removeAttr("disabled"))},Dea.hideSelectBoxes=function(){var t,n,i;if(document.all)for(t=document.getElementsByTagName("select"),n=0,i=t.length;n<i;n++)t[n].style.visibility="hidden"},Dea.displaySelectBoxes=function(){var t,n,i;if(document.all)for(t=document.getElementsByTagName("select"),n=0,i=t.length;n<i;n++)t[n].style.visibility="visible"},Dea.htmlDecode=function(n){if(n&&n!=="undefined")return n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},Dea.hideTimePicker=function(){var n=Dea.Get("timeDrop");n&&(bLeaveTime?timeBuilt===!0&&Dea.hideSelectBoxes():timeBuilt===!0&&(Dea.setDisplay(n,"none"),Dea.displaySelectBoxes(),timeBuilt=!1))},Dea.hidePickers=function(){Dea.Get("calendar")&&(bShow||hideCalendar(),bShow=!1),parent.gPopupIsShown&&parent.Dea.hideSelectBoxes(),Dea.hideTimePicker()},Dea.clearLoading=function(){Dea.setDisplay("CallbackStatus","none")},Dea.isMaxLengthValid=function(n,t){return n.length<=t},Dea.errorCallback=function(n){try{var i=Dea.JSON.parse(n)}catch(r){i=n}if(typeof i.sendToPage!="undefined")return window.location.href=i.sendToPage,!0;alert(n),Dea.clearLoading()},Dea.showLoading=function(){Dea.setDisplay("CallbackStatus","",null,"5px",null,"5px")},Dea.makeCallback=function(n,t,i){t&&t!=="undefined"||(t=Dea.emsData),t.router=n,t.deaCSRFToken=$("#"+deaCSRFTokenField).val(),i||Dea.showLoading(),Dea.pageCallback(t)},Dea.handleCallback=function(n,t){var i,r,e,f;try{i=Dea.JSON.parse(n)}catch(s){if(s.message==="script stack space quota is exhausted"){var i={},u=n.split('","'),o=u[0];for(o=o.substr(2,o.length-2),r=o.split('":"'),eval("emsResponse."+r[0]+' = "'+r[1]+'"'),e=1;e<u.length-1;e++)r=u[e].split('":"'),eval("emsResponse."+r[0]+' = "'+r[1]+'"');f=u[u.length-1],f=f.substr(0,f.length-2),r=f.split('":"'),eval("emsResponse."+r[0]+' = "'+r[1]+'"')}else i=n}if(typeof i.success!="undefined"&&Number(i.success)===0&&typeof i.msg!="undefined")return(alert(i.msg),typeof i.sendToPage!="undefined")?(window.location.href=i.sendToPage,!0):(typeof Dea.pageHandleErrorCallback=="function"&&Dea.pageHandleErrorCallback(i,t),Dea.clearLoading(),!0);if(typeof i.sendToPage!="undefined")return window.location.href=i.sendToPage,!0;if(typeof i.isError!="undefined"&&Number(i.isError)===1)return alert(i.errorMsg),Dea.clearLoading(),typeof Dea.pageHandleErrorCallback=="function"&&Dea.pageHandleErrorCallback(i,t),!0;Dea.pageHandleCallback(i,t)||alert("Unhandled callback "+t),typeof Dea.emsData.suppressImageWireUp=="undefined"?Dea.addImageRollovers():Dea.emsData.suppressImageWireUp==0&&Dea.addImageRollovers(),Dea.clearLoading()},$.ctrl=function(n,t,i){$(document).keydown(function(r){return i||(i=[]),r.keyCode==n.charCodeAt(0)&&r.ctrlKey?(t.apply(this,i),!1):void 0})},Dea.loadLabels=function(){_emsLabelsOnPage===null&&(_emsLabelsOnPage=document.getElementsByTagName("label"))},Dea.getLabelFromForAttr=function(n){Dea.loadLabels();for(var t=0;t<_emsLabelsOnPage.length;t++)if(_emsLabelsOnPage[t].attributes["for"]!==null&&_emsLabelsOnPage[t].attributes["for"]!==undefined&&_emsLabelsOnPage[t].attributes["for"].value===n)return _emsLabelsOnPage[t];return null},Dea.addRequiredAsterisk=function(n){return n.indexOf(">*<")<0&&(n+='<span class="requiredAsterisk">*<\/span>'),n},Dea.setLabelText=function(n,t){var i=Dea.getLabelFromForAttr(t),r;i!==null&&(n+=":",r=Dea.Get(t),n=r.isRequired?Dea.addRequiredAsterisk(n):n.replace('<span class="requiredAsterisk">*<\/span>',""),i.innerHTML=n)},Dea.setLabelRequired=function(n){var t=Dea.getLabelFromForAttr(n);t!==null&&(t.innerHTML=Dea.addRequiredAsterisk(t.innerHTML))},$$=function(n){return $("#"+n)},$emsid=function(n){return $(Dea.Get(n))},Dea.addImageRollovers=function(){$("input[src*='btn-']").each(function(){Dea.addRollover($(this).attr("src"),$(this))}),$("img[src*='btn-']").each(function(){Dea.addRollover($(this).attr("src"),$(this))})},Dea.calRollover=function(n){$("img[src='"+n+"']").each(function(){Dea.addRollover($(this).attr("src"),$(this))})},Dea.addRollover=function(n,t){function i(n){var t=n.substring(n.lastIndexOf("/")+1),i=t.split("-");return i.length>2?!0:!1}function r(n){var r=n.substring(n.lastIndexOf("/")+1),t=r.split("-"),i=t[1].split(".");return PathToRoot+"images/"+t[0]+"-"+i[0]+"-over."+i[1]}if(!i(n)){var u=r(n);$(t).css("cursor","pointer").hover(function(){$(t).attr("src",u)},function(){$(t).attr("src",n)})}};$(document).on("mousemove",function(n){Dea.Mouse.X=n.pageX,Dea.Mouse.Y=n.pageY});Dea.setPopup=function(){$("#emsBody").removeClass("emsBody"),$("#FooterContainer").hide(),$("#emsCon").removeClass("emsCon"),$("div[class*=master]").removeClass()},Dea.IsValidEmail=function(n){var t=/\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;return n.trim().length>0?t.test(n):!0},Dea.showTip=function(n,t){$activeTipId=Dea.emsData.tipItemId,$("#tipDiv").html(n),$("#tipDiv").dialog({width:400,title:t,position:[Dea.mouseX,Dea.mouseY-$(window).scrollTop()]}).dialog("open")},Dea.anchorTimes=function(n,t){var i=$.timePicker("#"+n).getTime();$$(n).change(function(){var f,r,u;$$(n).val().length<ems_timeFormat.length||($$(t).val()?(f=$.timePicker("#"+t).getTime()-i,r=$.timePicker("#"+n).getTime(),$.timePicker("#"+t).setTime(new Date(new Date(r.getTime()+f))),i=r,$("#"+t).focus()):(r=$.timePicker("#"+n).getTime(),u=new Date(new Date(r.getTime())),u.setMinutes(u.getMinutes()+60),$.timePicker("#"+t).setTime(u),i=r,$("#"+t).focus()))})},Dea.setTabs=function(n){$("ul.ui-tabs-nav").after('<div class="ui-widget-header ui-state-active tabLine" style="height:.5em;"><\/div>'),$("ul.ui-widget-header").removeClass("ui-widget-header"),n&&$("#"+n).removeClass("ui-widget-content")},Dea.checkVersion=function(){var t=Dea.getInternetExplorerVersion()},Dea.getInternetExplorerVersion=function(){var n=-1,t,i;return navigator.appName=="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n},typeof Dea.dp=="undefined"&&(Dea.dp={}),Dea.dp.checkHoliday=function(n){var u;if(typeof DeaHolidays=="object"){var r=n.getDate(),i=n.getMonth()+1,t=n.getFullYear();if(DeaHolidays[t]&&DeaHolidays[t][i]&&DeaHolidays[t][i][r])return u=DeaHolidays[t][i][r],[!0,"hol",u.tooltip]}return[!0,""]},$(document).ready(function(){if(ems_useHelpIcon===1){$("#helpDialog").dialog({title:ems_Help,autoOpen:!1,width:400,height:300,modal:!1,resizable:!0});$("#helpIco").attr({alt:ems_Help,title:ems_Help}).on("click",function(){$("#helpDialog").dialog("open")});($("#ctl00_DefaultHelp").is(":empty")||$("#ctl00_DefaultHelp").html()==null||$("#ctl00_DefaultHelp").html().trim()=="<br>"||$("#ctl00_DefaultHelp").html().trim()=="")&&$("#helpIco").hide()}else $("#helpIco").hide();$("body").append("<div id='tipDiv'><\/div>"),$("#tipDiv").dialog({autoOpen:!1,resizable:!1}),$(".ui-dialog-titlebar-close").attr("aria-label","close"),Dea.addImageRollovers(),$.idleTimer(ems_sessionMilli),$(document).bind("idle.idleTimer",function(){window.location.href=ems_timeOutUrl});$(".staticMenu").on("focus",function(){var n=$(this).closest("table"),t=$(n).parent();$(t).trigger("mouseover")});$(".staticMenu").on("blur",function(){var n=$(this).closest("table");$(n).removeClass("staticMenuOver").addClass("staticMenu"),$(this).removeClass("staticMenuOver").addClass("staticMenu")})}),function(n){n.idleTimer=function(t,i){var o=!1,e=!0,u=3e4,s="mousemove keydown DOMMouseScroll mousewheel mousedown";i=i||document;var f=function(t){var r,s,o;if(typeof t=="number"&&(t=undefined),r=n.data(t||i,"idleTimerObj"),r.idle=!r.idle,s=+new Date-r.olddate,r.olddate=+new Date,r.idle&&s<u){r.idle=!1,clearTimeout(n.idleTimer.tId),e&&(n.idleTimer.tId=setTimeout(f,u));return}o=jQuery.Event(n.data(i,"idleTimer",r.idle?"idle":"active")+".idleTimer"),o.stopPropagation(),n(i).trigger(o)},h=function(t){var i=n.data(t,"idleTimerObj");i.enabled=!1,clearTimeout(i.tId),n(t).unbind(".idleTimer")},c=function(){var t=n.data(this,"idleTimerObj");clearTimeout(t.tId),t.enabled&&(t.idle&&f(this),t.tId=setTimeout(f,t.timeout))},r=n.data(i,"idleTimerObj")||new function(){};if(r.olddate=r.olddate||+new Date,typeof t=="number")u=t;else{if(t==="destroy")return h(i),this;if(t==="getElapsedTime")return+new Date-r.olddate}n(i).bind(n.trim((s+" ").split(" ").join(".idleTimer ")),c),r.idle=o,r.enabled=e,r.timeout=u,r.tId=setTimeout(f,r.timeout),n.data(i,"idleTimer","active"),n.data(i,"idleTimerObj",r)},n.fn.idleTimer=function(t){return this[0]&&n.idleTimer(t,this[0]),this}}(jQuery),function(n){n.fn.extend(n.ui.tabs.prototype,{_create:function(){var t=this,i=this.options,u,f,r;for(n.address&&(u={enable:!0,title:{enable:!0,split:" | "}},n.isEmptyObject(i.jqAddress)?i.jqAddress={}:n.extend(!0,u,i.jqAddress),n.extend(!0,i.jqAddress,u)),n.address&&i.jqAddress.enable&&(f="#"+n.address.value().replace("/","")),t._tabify(!0),t.element.attr("role","application"),t.list.attr("role","tablist"),r=0;r<t.anchors.length;r++)n.address&&i.jqAddress.enable&&f!="#"&&n(t.anchors[r]).attr("href")==f&&t.select(r),t._ariaInit(r);t.element.keydown(function(r){if(document.activeElement){var u=document.activeElement.tagName;if(u!=="INPUT"&&u!=="SELECT"&&u!=="TEXTAREA")switch(r.keyCode){case n.ui.keyCode.RIGHT:r.preventDefault(),t.select(i.selected+1);break;case n.ui.keyCode.DOWN:r.preventDefault(),t.select(i.selected+1);break;case n.ui.keyCode.UP:r.preventDefault(),t.select(i.selected-1);break;case n.ui.keyCode.LEFT:r.preventDefault(),t.select(i.selected-1);break;case n.ui.keyCode.END:r.preventDefault(),t.select(t.anchors.length-1);break;case n.ui.keyCode.HOME:r.preventDefault(),t.select(0)}}}),n.address&&this.options.jqAddress.enable&&n.address.externalChange(function(i){for(var u="#"+i.value.replace("/",""),r=0;r<t.anchors.length;){if(n(t.anchors[r]).attr("href")==u){t.select(r);return}r++}})},_original_load:n.ui.tabs.prototype.load,load:function(t){for(var i=0;i<this.anchors.length;i++)this._ariaSet(i,!1),n.data(this.anchors[i],"href.tabs")&&n(this.panels[i]).removeAttr("aria-live").removeAttr("aria-busy");(n.data(this.anchors[t],"href.tabs")||n(this.anchors[t]).attr("data-isAjax")==="1")&&n(this.panels[t]).attr("aria-live","polite").attr("aria-busy","true"),this._original_load(t),n.address&&this.options.jqAddress.enable&&(this.options.jqAddress.title.enable&&n.address.title(n.address.title().split(this.options.jqAddress.title.split)[0]+this.options.jqAddress.title.split+n(this.anchors[t]).text()),n.address.value(n(this.anchors[t]).attr("href").replace(/^#/,""))),(n.data(this.anchors[t],"href.tabs")||n(this.anchors[t]).attr("data-isAjax")==="1")&&n(this.panels[t]).attr("aria-busy","false"),this._ariaSet(t,!0),this._updateVirtualBuffer()},_ariaSet:function(t,i){var r=i?0:-1;n(this.anchors[t]).attr("tabindex",r).attr("aria-selected",i),n(this.panels[t]).attr("aria-hidden",!i).attr("aria-expanded",i)},_ariaInit:function(t){var i=this,r=n(this.panels[t]).attr("id");n(i.anchors[t]).attr("role","tab").attr("aria-controls",r).attr("id",r+"-tab").parent().attr("role","presentation"),n(this.panels[t]).attr("role","tabpanel").attr("aria-labelledby",r+"-tab"),this.options.collapsible&&n(this.anchors[t]).bind(this.options.event,function(){i._ariaSet(t,!n(i.panels[t]).hasClass("ui-tabs-hide"))})},_original_add:n.ui.tabs.prototype.add,add:function(n,t,i){this._original_add(n,t,i),this.element.attr("aria-live","polite").attr("aria-relevant","additions"),i?(this._ariaInit(i),this._ariaSet(i,!1)):(this._ariaInit(this.anchors.length-1),this._ariaSet(this.anchors.length-1,!1))},_original_remove:n.ui.tabs.prototype.remove,remove:function(n){this._original_remove(n),this.element.attr("aria-live","polite").attr("aria-relevant","removals")},_original_destroy:n.ui.tabs.prototype.destroy,destroy:function(){var t=this,r=this.options,i;for(t.element.removeAttr("role").removeAttr("aria-live").removeAttr("aria-relevant"),t.list.removeAttr("role"),i=0;i<t.anchors.length;i++)n(t.anchors[i]).removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("role").removeAttr("id").removeAttr("tabindex").parent().removeAttr("role"),n(t.panels[i]).removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("aria-labelledby").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-relevant").removeAttr("role");n("body>form #virtualBufferForm").parent().remove(),this._original_destroy()},_updateVirtualBuffer:function(){var t=n("body>form #virtualBufferForm"),i;t.length?t.val()=="1"?t.val("0"):t.val("1"):(i='<form method="post"><input id="virtualBufferForm" type="hidden" value="1" /><\/form>',n("body").append(i))}})}(jQuery),vems=vems||{},vems.screenText={},vems.sessionConsts={minutes:"sessionMinutes",isAuthed:"isAuthed"},vems.helpText={parentId:0},vems.serverApiUrl=function(){return"ServerApi.aspx"},vems.decodeHtml=function(n){return $("<textarea>").html(n).text()},vems.encodeHtml=function(n){return $("<div/>").text(n).html()},vems.isLocale24HrFormat=function(){return vems.is24HrFormat?vems.is24HrFormat:!1},vems.bindLocalStorageListeners=function(n){window.addEventListener("storage",function(t){switch(t.key){case vems.sessionConsts.minutes:parseInt(t.newValue)>0&&vems.activeSessionTimer&&($("#confirmation-modal").modal("hide"),vems.activeSessionTimer.stopTimer(),vems.activeSessionTimer.minuteCounter=parseInt(t.newValue),vems.activeSessionTimer.startTimer());break;case vems.sessionConsts.isAuthed:t.newValue.toLowerCase()==="false"&&t.oldValue.toLowerCase()==="true"&&window.location.href.indexOf(n)===-1&&(window.location.href=n)}})},vems.sessionTimer=function(n){var i,t=this,u=n.minutes||20,r;t.minuteCounter=u;var f=n.onTimerStart||function(){},e=n.onUpdate||function(){},o=n.onTimerEnd||function(){};return t.startTimer=function(){f(),i=0,i=setInterval(t.decrementTimer,6e4)},t.decrementTimer=function(){e(),t.minuteCounter--,t.minuteCounter===0?(t.stopTimer(),o()):r()},t.stopTimer=function(){clearInterval(i)},t.resetTimer=function(){t.stopTimer(),t.minuteCounter=u,r(),t.startTimer()},r=function(){localStorage.setItem(vems.sessionConsts.minutes,-1),localStorage.setItem(vems.sessionConsts.minutes,t.minuteCounter)},t},vems.showAlertMessage=function(n,t){var i=$("#confirmation-modal").modal();return $("#confirmation-modal .modal-body").html(n),$("#confirmation-modal .modal-title").html(t),i.show(),i},vems.showModalMessageWithButtons=function(n,t,i,r,u,f,e){var o=$("#confirmation-modal").modal(),h=$("#confirmation-modal .modal-body"),l,s,c;h.html(""),h.html(n),$("#confirmation-modal .modal-title").html(t),l=$('<div class="text-right" style="padding: 10px"><button type="button" class="btn btn-primary" id="action-button-1"><\/button> <button type="button" class="btn btn-default" id="close-button-1" data-dismiss="modal">Close<\/button><\/div>'),l.appendTo(h),(i=="undefined"||i.length==0)&&(i="Yes"),(r=="undefined"||r.length==0)&&(r="Close"),s=$(o).find("#action-button-1"),s.html(i),c=$(o).find("#close-button-1"),c.html(r);$(c).on("click",function(n){f(n),$(o).off("hidden.bs.modal"),o.modal("hide")});$(o).off("hidden.bs.modal"),$(s).off("click");$(o).on("hidden.bs.modal",function(n){e(n)});$(s).off("click");$(s).on("click",function(n){u(n),$(o).off("hidden.bs.modal"),o.modal("hide")});return o.show(),o},vems.showConfirmationMessage=function(n,t){return DevExpress.ui.dialog.confirm(n,t)},vems.toggleSideBar=function(){var n=$("#sidebar-wrapper"),t,i;n.width()<1?(n.width("250px"),n.css("overflow-y","auto"),$("body").addClass("no-scroll"),t=document.getElementById("sidebar-wrapper"),i=document.getElementById("page-content-wrapper"),document.body.addEventListener("touchmove",function(n){n.path.indexOf(t)!==-1&&n.path.indexOf(i)!==-1&&n.preventDefault()})):(n.width("0"),n.css("overflow-y","hidden"),DevExpress.devices.real().phone||$(".navbar-toggle").addClass("navbar-toggle-override"),$(".navbar-toggle").show(),$("body").removeClass("no-scroll"))},vems.isSideBarShown=function(){return $("#sidebar-wrapper").width()>0},vems.showToasterMessage=function(n,t,i,r,u,f,e){e==undefined&&(e=!0),e&&$(".toaster").empty(),n||(n=""),r||(r=5e3),f||(f="body"),$.toaster({priority:i,title:n,message:t,settings:{timeout:r,toaster:{container:f}}});var o=$("#toaster");if($.isFunction(u))o.on("close.bs.alert",function(n){u(n)});return o},vems.showErrorToasterMessage=function(n,t,i){return(typeof t=="undefined"||t===null)&&(t=5e3),(typeof i=="undefined"||i===null)&&(i=""),$.toaster({priority:"danger",title:i,message:n,settings:{timeout:t}}),$("#toaster")},vems.getAjaxPostDefaults=function(){var n=$("#deaCSRFToken").val();return{type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",headers:{"dea-CSRFToken":n}}},vems.ajaxPost=function(n,t){return $.extend(n,vems.getAjaxPostDefaults()),$.ajax(n).error(function(i,r,u){var e=u,f;!t&&i.responseText&&(i.responseText.substr(0,1)!="<"&&(f=JSON.parse(i.responseText),f.d&&(f=JSON.parse(f.d)),!f.Success&&f.ErrorMessage&&(e=f.ErrorMessage)),vems.showToasterMessage("",e,"danger")),n.url&&(e="Error calling "+n.url+": "+e),console.log("vems.ajaxPost error: "+e)})},vems.menuVM=function(){function u(){return $.grep(i,function(n){return n.IsMainMenuItem})}function f(){var n=[],t=[],r=[];return $.each(i,function(){switch(this.Id){case 3:$.each(this.ChildMenus,function(){n.push(this)});break;case 14:$.each(this.ChildMenus,function(){t.push(this)})}}),$.each(n,function(t,i){if(i.Id===-11)return r.push(i),n=$.grep(n,function(n){return n.Id!==-11}),!1}),{user:n,admin:t,signOut:r}}function e(){var n=[],t=[];return $.each(i,function(){if(this.Id===33)return $.each(this.ChildMenus,function(){this.Id>0?t.push(this):n.push(this)}),!1}),{main:n,custom:t}}var n=this,i=window.menuJSON,t,r;n.mainMenuItems=ko.observableArray(u()),t=f(),n.userMenuItems=ko.observableArray(t.user),n.adminMenuItems=ko.observableArray(t.admin),n.signOutMenuItems=ko.observableArray(t.signOut),r=e(),n.helpMenuItems=ko.observableArray(r.main),n.customHelpMenuItems=ko.observableArray(r.custom),n.OnMenuItemPage=function(n){if(n.length===0)return!1;var t=window.location.toString().toLowerCase();return t.indexOf(".aspx")===-1&&n.toLowerCase().indexOf("default")>-1?!0:t.indexOf(n.split(".aspx")[0].toLowerCase())!==-1},n.menuItemClicked=function(n){if(n.NavigateUrl.length===0)return!1;n.Target!=null?window.open(n.NavigateUrl,n.Target):window.location=n.NavigateUrl}},vems.toggleCheckIn=function(n,t,i){return vems.ajaxPost({url:vems.serverApiUrl()+"/toggleCheckinJson",data:"{groupId : "+n+", buildingId: "+t+", bookingId: "+i+"}"})},vems.GetICSDownload=function(n,t,i){return n||(n=0),t||(t=0),i&&i.preventDefault(),window.location.href="ICSDownload.aspx?BookingId="+n+"&ReservationId="+t,!1},vems.sendEmail=function(n){vems.ajaxPost({url:vems.serverApiUrl()+"/SendEmail",data:ko.toJSON({emailHash:n}),success:function(){vems.showToasterMessage("","Email Sent","success")},error:function(n,t,i){return console.log(i),!1}})},vems.validationClasses={highlight:function(n){$(n).parent().addClass("has-error")},unhighlight:function(n){$(n).parent().removeClass("has-error")},errorClass:"help-block"},$(document).ready(function(){DevExpress.devices.real().phone&&$(".help-text-icon").hide();var n=new vems.menuVM;ko.applyBindings(n,$("#sidebar-wrapper ul")[0]),ko.applyBindings(n,$("#help-icon ul")[0]),ko.applyBindings(n,$("#user-menu-dropdown")[0]),$("#user-menu-dropdown").children().last().hasClass("divider")&&$("#user-menu-dropdown").children().last().hide()});$(document).on("ajaxStart ajaxStop",function(n){switch(n.type){case"ajaxStop":vems.activeSessionTimer&&vems.activeSessionTimer.resetTimer()}});$.validator.addMethod("sanitize",function(n){var u=this,r=bleach.sanitize(n,{mode:"white",list:[]});return r===n},"Invalid Format"),$.validator.addMethod("trim",function(n){return n.trim().length>0},"Invalid Characters"),vems.htmlEncode=function(n){return $("<div/>").text(n).html()},vems.htmlDecode=function(n){return $("<div/>").html(n).text()},vems.replaceBreaks=function(n){return n.replace(/<br>/gi,"\n").replace(/<br\/>/gi,"\n").replace(/<br \/>/gi,"\n")},vems.pageLoading=function(n){$("#page-loading-overlay").height($(document).height()),$("#page-loading-overlay").width($(document).width()),n?$("#page-loading-overlay").show():$("#page-loading-overlay").hide()};$(document).on("show.bs.modal",function(){$("#toaster").remove()});$(document).on("click",".help-text-icon, .HelpTextEditLink",function(n){var t=$(n.currentTarget).data("helptextkey"),i=$(n.currentTarget).data("parenttype"),r=$(n.currentTarget).data("parameterkeys")?$(n.currentTarget).data("parameterkeys"):"",u=$(n.currentTarget).data("parentid")?$(n.currentTarget).data("parentid"):vems.helpText.parentId;$("#help-text-modal").data("caller",n.currentTarget),vems.ajaxPost({url:vems.serverApiUrl()+"/GetHelpTextRecord",data:ko.toJSON({key:t,parentType:i,parentId:u,parameterKeys:r}),success:function(n){var t=JSON.parse(n.d);t.Success?($("#help-text-body-content").html(t.SuccessMessage),$("#help-text-modal").modal("show")):vems.showErrorToasterMessage(t.ErrorMessage)},error:function(n,t,i){return console.log(i),!1}})}).on("click",".help-text-edit",function(){var t=$("#help-text-modal").data("caller"),i=$(t).data("helptextkey"),r=$(t).data("parenttype"),u=$(t).data("parameterkeys")?$(t).data("parameterkeys"):"",f=$(t).data("parentid")?$(t).data("parentid"):vems.helpText.parentId;return vems.ajaxPost({url:vems.serverApiUrl()+"/GetWebTextCultures",data:ko.toJSON({key:i,parentType:r,parentId:f,parameterKeys:u,translationId:0,isPostBack:!1}),success:function(n){var i=JSON.parse(n.d),t;i.Success?(t=JSON.parse(i.JsonData),$("#webtext-culture-drop option").remove(),$.each(t.Cultures,function(n,t){$("#webtext-culture-drop").append($("<option><\/option>").val(t.Id).html(vems.decodeHtml(t.Description)))}),$("#help-text-close-btn").hide(),$("#help-text-save-btn").show(),$("#help-text-cancel-btn").show(),$("#help-text-modal #help-text-body-content").hide(),$("#help-text-modal #help-text-body-edit-content").show(),t.WebText.length>0&&$("#help-text-modal #help-text-body-edit-content #webtext-editor").val(t.WebText[0].Text),setTimeout(function(){$("#webtext-editor").htmlarea({toolbar:[[{css:"html",text:"Show/Hide HTML Source View",action:function(){this.toggleHTMLView(),this.textarea.data("initialValueSet")||(this.textarea.data("initialValueSet",!0),this.textarea.val(t.WebText[0].Text))}}],["bold","italic","underline","strikethrough"],["link","unlink","image"],["orderedlist","unorderedlist","superscript","subscript","indent","outdent"],["justifyleft","justifycenter","justifyright","increasefontsize","decreasefontsize","forecolor","horizontalrule"]]})},0)):vems.showErrorToasterMessage(i.ErrorMessage)},error:function(n,t,i){return console.log(i),!1}}),!1}).on("hidden.bs.modal","#help-text-modal",function(){$("#help-text-modal #help-text-body-content").show(),$("#help-text-modal #help-text-body-edit-content").hide(),$("#help-text-close-btn").show(),$("#help-text-save-btn").hide(),$("#help-text-cancel-btn").hide()}).on("change","#webtext-culture-drop",function(){var n=$("#help-text-modal").data("caller"),t=$(n).data("helptextkey"),i=$(n).data("parenttype"),r=$(n).data("parameterkeys")?$(n).data("parameterkeys"):"",u=$(n).data("parentid")?$(n).data("parentid"):vems.helpText.parentId,f=$("#webtext-culture-drop").val(),e=!0;vems.ajaxPost({url:vems.serverApiUrl()+"/GetWebTextCultures",data:ko.toJSON({key:t,parentType:i,parentId:u,parameterKeys:r,translationId:f,isPostBack:!0}),success:function(n){var t=JSON.parse(n.d),i;t.Success?(i=JSON.parse(t.JsonData),i.WebText.length>0?$("#webtext-editor").htmlarea("html",i.WebText[0].Text):$("#webtext-editor").htmlarea("html","")):vems.showErrorToasterMessage(t.ErrorMessage)},error:function(n,t,i){return console.log(i),!1}})}).on("click","#help-text-save-btn",function(){var n=$("#help-text-modal").data("caller"),t=$(n).data("helptextkey"),i=$(n).data("parenttype"),f=$(n).data("parameterkeys")?$(n).data("parameterkeys"):"",r=$(n).data("parentid")?$(n).data("parentid"):vems.helpText.parentId,u=$("#webtext-culture-drop").val();vems.ajaxPost({url:vems.serverApiUrl()+"/UpdateWebTextRecord",data:ko.toJSON({key:t,parentType:i,parentId:r,translationId:u,text:vems.maxInputLength>0?$("#webtext-editor").htmlarea("html").substring(0,vems.maxInputLength):$("#webtext-editor").htmlarea("html")}),success:function(n){var t=JSON.parse(n.d);t.Success?($("#help-text-modal").modal("hide"),vems.showToasterMessage("",t.SuccessMessage,"success",2e3)):vems.showErrorToasterMessage(t.ErrorMessage)},error:function(n,t,i){return console.log(i),!1}})});ko.subscribable.fn.subscribeChanged=function(n){var t=this.peek();return this.subscribe(function(i){var r=t;t=i,n(i,r)})},ko.bindingHandlers.currency={update:function(n,t){return ko.bindingHandlers.text.update(n,function(){var n=+(ko.utils.unwrapObservable(t())||0),i="$";return i+n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")})}},koValueBindingInit=ko.bindingHandlers.value.init,koValueBindingUpdate=ko.bindingHandlers.value.update,ko.bindingHandlers.value={init:function(n,t,i,r,u){koValueBindingInit(n,t,i,r,u),ko.bindingHandlers.value.postValueUpdated.call(r,n)},update:function(n,t,i,r,u){var f=ko.utils.unwrapObservable(t());koValueBindingUpdate(n,t,i,r,u),ko.bindingHandlers.value.postValueUpdated.call(r,n,i)},postValueUpdated:function(n,t){vems.postValueUpdate(n,t)}},koTextInputBindingInit=ko.bindingHandlers.textInput.init,ko.bindingHandlers.textInput={init:function(n,t,i,r,u){koTextInputBindingInit(n,t,i,r,u),ko.bindingHandlers.textInput.postValueUpdated.call(r,n)},update:function(n,t,i,r){var f=ko.utils.unwrapObservable(t());ko.bindingHandlers.textInput.postValueUpdated.call(r,n,i)},postValueUpdated:function(n,t){vems.postValueUpdate(n,t)}},ko.bindingHandlers.bootstrapToggle={init:function(n,t){var u,f;$(n).bootstrapToggle(),u=$(n).prop("disabled"),$(n).bootstrapToggle("enable"),f=ko.utils.unwrapObservable(t()),f?$(n).bootstrapToggle("on"):$(n).bootstrapToggle("off");$(n).on("change",function(){t()($(this).prop("checked"))});u&&$(n).bootstrapToggle("disable")},update:function(n,t){var f=$(n).prop("disabled"),u;$(n).bootstrapToggle("enable"),u=ko.utils.unwrapObservable(t()),u?$(n).bootstrapToggle("on"):$(n).bootstrapToggle("off"),f&&$(n).bootstrapToggle("disable")}},vems.postValueUpdate=function(n,t){var i=$(n),u=i.attr("required")!=undefined||i.hasClass("required"),r;u||t==undefined||t().attr==undefined||t().attr.required==undefined||(u=!0),u&&(i.is("select")&&(i.val()!=null&&i.val()>0?i.css("border-color","#ccc"):i.css("border-color","#a94442")),(i.is("input")||i.is("textarea"))&&(i.val()!=null&&i.val().length>0?i.css("border-color","#ccc"):i.css("border-color","#a94442"))),i.is('div.date:not([id="booking-start"],[id="booking-end"])')&&(r=i.children("input[required], input.required"),r.length>0&&(i.data("date").length>0?r.css("border-color","#ccc"):r.css("border-color","#a94442")),r&&r.length!=0||i.siblings(".validation-error-message").remove())};$(document).on("keyup","input.required, input[required], textarea.required, textarea[required]",function(n){vems.postValueUpdate(n.currentTarget)}).on("change","select.required, select[required]",function(n){vems.postValueUpdate(n.currentTarget)}).on("dp.change","div.date",function(n){vems.postValueUpdate(n.currentTarget)});vems.bindLoadingGifsToTypeAhead=function(n,t){if(n){var i="search-loading";t&&t.length>0&&(i=t),$(n).parent().parent().append('<img class="input-icon-embed '+i+'" src="Images/Loading.gif" />'),n.unbind("typeahead:asyncrequest").bind("typeahead:asyncrequest",function(n){$(n.currentTarget).parent().parent().find("i.fa-search").css("display","none"),$(n.currentTarget).parent().parent().find(".search-loading").css("display","inline")}).unbind("typeahead:render").bind("typeahead:render",function(n){$(n.currentTarget).parent().parent().find(".search-loading").css("display","none"),$(n.currentTarget).parent().parent().find("i.fa-search").css("display","inline")}).unbind("typeahead:asynccancel").bind("typeahead:asynccancel",function(n){$(n.currentTarget).parent().parent().find(".search-loading").css("display","none"),$(n.currentTarget).parent().parent().find("i.fa-search").css("display","inline")})}},vems.convertTabsForMobile=function(){$(".nav-tabs").addClass("mobile-nav-tabs"),$(".nav-tabs li").addClass("row").addClass("col-xs-12"),$(".nav-tabs a").addClass("mobile-tab")},vems.initNumericKoBinding=function(){ko.bindingHandlers.numeric={init:function(n){$(n).on("keydown",function(n){vems.isValidNumericKeyEvent(n)||n.preventDefault()})}}},vems.initNumericAttendanceInputs=function(n){n.off("keydown",".vems-numeric-attendance").on("keydown",".vems-numeric-attendance",function(n){vems.isValidNumericKeyEvent(n)||n.preventDefault()}).off("keyup",".vems-numeric-attendance").on("keyup",".vems-numeric-attendance",function(){var t=$(this).val();isNaN(t)||t<0||!t?$(this).val(0):t>999999?$(this).val(999999):t.charAt(0).toString()==="0"&&$(this).val(parseInt(t))})},vems.initNumericUdfInputs=function(n){n.off("keydown",".vems-numeric-udf").on("keydown",".vems-numeric-udf",function(n){vems.isValidNumericKeyEvent(n)||n.preventDefault()}).off("keyup",".vems-numeric-udf").on("keyup",".vems-numeric-udf",function(){var t=$(this).val();isNaN(t)?($(this).val(0),ko.dataFor(this).Answer($(this).val())):t<-999999999?($(this).val(-999999999),ko.dataFor(this).Answer($(this).val())):t>999999999&&($(this).val(999999999),ko.dataFor(this).Answer($(this).val()))})},vems.isValidNumericKeyEvent=function(n){var r=!!n.key,i,t;if(r)switch(n.key){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"Backspace":case"Delete":case"Del":case"Tab":case"Escape":case"Enter":case",":case"Comma":case".":case"Period":case"Decimal":case"NumpadDecimal":case"Home":case"End":case"ArrowLeft":case"ArrowRight":case"Left":case"Right":case"Shift":case"Control":return!0;case"a":case"KeyA":return!!n.ctrlKey;default:return!1}if(i=!!n.code,i)switch(n.code){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"Digit0":case"Digit1":case"Digit2":case"Digit3":case"Digit4":case"Digit5":case"Digit6":case"Digit7":case"Digit8":case"Digit9":case"Numpad0":case"Numpad1":case"Numpad2":case"Numpad3":case"Numpad4":case"Numpad5":case"Numpad6":case"Numpad7":case"Numpad8":case"Numpad9":case"Backspace":case"Delete":case"Tab":case"Escape":case"Enter":case"Comma":case"Period":case"Decimal":case"NumpadDecimal":case"Home":case"End":case"ArrowLeft":case"ArrowRight":case"ShiftLeft":case"ShiftRight":case"ControlLeft":case"ControlRight":return!0;case"KeyA":return!!n.ctrlKey;default:return!1}return t=parseInt(n.keyCode||n.which),!!(t>=48&&t<=57||t>=96&&t<=105||t===46||t===8||t===9||t===27||t===13||t===188||t===190||t===110||t===16||!!n.shiftKey||t===65&&!!n.ctrlKey||t>=35&&t<=39)},vems.authenticateSFB=function(n){var t=$("#conferencing-iframe").data("conferencingConfig");n===null||n.length===0?t.method===t.constants.NTLM?$("#conferencing-iframe").prop("src",$("#conferencing-iframe").data("src")):$("#conferencing-login-modal").modal({show:!0,backdrop:!0}):vems.validateToken(n)},vems.setSFBToken=function(n,t){function u(n){var t=n/3600,i=moment();return i.add(t,"hours").subtract(10,"minutes").unix()}var f=this,i=n.token,r=u(n.expires);vems.ajaxPost({url:vems.serverApiUrl()+"/SetConferencingAPIToken",data:JSON.stringify({token:n.token,adfsPassiveURL:t}),success:function(){var t=JSON.stringify({token:i,expires:r});localStorage.setItem("conferencingTokenData",t),$("#conferencing-login-modal").modal("hide")},error:function(n,t,i){console.log(i)}})},vems.validateToken=function(n){function f(n){var t=moment(),i=moment.unix(n.expires);return t.isBefore(i)}function e(n,i){if(i.method!==i.constants.Online){r();return}t.ajaxPost({url:vems.serverApiUrl()+"/RefreshUserConferencingTokens",data:JSON.stringify({}),success:function(n){var i=n.split(",");$.each(i,function(n,t){var i=JSON.parse(t.d);localStorage.setItem("conferencingTokenData",JSON.stringify({token:i.refresh_token,expires:i.expires_in}))}),t.showToasterMessage("",vems.roomRequest.ConferencingWillBeAddedMsg,"info"),roomRequestModel&&$.isFunction(roomRequestModel.reservationDetails.SendInvitation)&&roomRequestModel.reservationDetails.SendInvitation(!0)},error:function(){r()}})}function r(){var n=null;localStorage.setItem("conferencingTokenData","{}"),t.authenticateSFB(n)}var t=this,u=$("#conferencing-iframe").data("conferencingConfig"),i=JSON.parse(localStorage.getItem("conferencingTokenData"))||{};if(!i.token||!f(i)){e(n,u);return}t.showToasterMessage("",vems.roomRequest.ConferencingWillBeAddedMsg,"info"),roomRequestModel&&$.isFunction(roomRequestModel.reservationDetails.SendInvitation)&&roomRequestModel.reservationDetails.SendInvitation(!0)},vems=vems||{},vems.actAsModalShowing=function(n){$(n.target).on("click","#actas-ok-btn",function(){var n=$("#actas-modal-content .row-selected"),t;n.length===0?vems.showAlertMessage("Please select a user to impersonate."):(t=n.attr("data-email").replace("\\","\\\\").replace("'","\\'"),vems.ajaxPost({url:vems.serverApiUrl()+"/EnableDelegation",data:"{ delegateUserName: '"+t+"' }",success:function(){window.location.reload(!0)},error:function(n,t,i){return console.log(i),!1}}))});$(n.target).on("click","#actas-stop-acting",function(){var n=$(".actas-modal-message").attr("data-email").replace("\\","\\\\").replace("'","\\'");vems.ajaxPost({url:vems.serverApiUrl()+"/EnableDelegation",data:"{ delegateUserName: '"+n+"' }",success:function(){window.location.reload(!0)},error:function(n,t,i){return console.log(i),!1}})});$(n.target).on("keyup","#actas-search-input",function(){var n=ko.dataFor(this),t=this.value.toLowerCase();n.DelegatesSearchResults($.grep(n.Delegates(),function(n){return n.UserName().toLowerCase().indexOf(t)>-1})),$("#actas-modal-content .row-selected").length===0&&$("#actas-ok-btn").attr("disabled","disabled")});$(n.target).on("click",".row-selectable",function(){$("#actas-modal-content .row-selectable").removeClass("row-selected"),$(this).addClass("row-selected"),$("#actas-ok-btn").removeAttr("disabled")});vems.ajaxPost({url:vems.serverApiUrl()+"/GetUserImpersonationList",success:function(n){typeof ko.dataFor($("#actas-modal-content")[0])=="undefined"?(vems.actAsVM=ko.mapping.fromJS(JSON.parse(n.d)),ko.applyBindings(vems.actAsVM,$("#actas-modal-content")[0])):typeof vems.actAsVM=="undefined"?vems.actAsVM=ko.mapping.fromJS(JSON.parse(n.d)):ko.mapping.fromJS(JSON.parse(n.d),vems.actAsVM),$("#actas-search-input").val(""),$("#actas-ok-btn").attr("disabled","disabled")},error:function(n,t,i){return console.log(i),!1}})}